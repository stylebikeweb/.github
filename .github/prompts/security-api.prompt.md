# Secure REST API & GraphQL Review Checklist

## 認証・認可 🔒
* すべてのエンドポイントが適切な認証・認可で保護されているか
* JWTトークンには適切な有効期限と署名アルゴリズムが設定されているか
* 権限の最小化原則が遵守されているか
* セッション管理が適切に実装されているか
* 【GraphQL】フィールドレベルの認可制御が実装されているか

## 入力検証とデータ処理 ⚠️
* すべてのユーザー入力がサーバーサイドで検証されているか
* SQLインジェクション、XSS、CSRFなどの脆弱性対策が施されているか
* レスポンスでの機密情報の漏洩がないか
* ファイルアップロード処理が安全か
* 【GraphQL】入力バリデーションスキーマが適切に設定されているか

## レート制限と負荷対策 🚦
* APIレート制限が実装されているか
* IPベースの制限と認証ベースの制限の組み合わせはあるか
* DoS攻撃対策が考慮されているか
* 【GraphQL】クエリの複雑さや深さの制限が設定されているか
* 【GraphQL】N+1問題に対する対策が実装されているか

## セキュリティヘッダーと通信 🔐
* 適切なCORSポリシーが設定されているか
* Content-Security-Policy, X-Content-Type-Options などの重要ヘッダーが設定されているか
* HTTPS通信が強制されているか
* 【GraphQL】エンドポイントに適切なCORS設定がされているか

## ログとモニタリング 📊
* セキュリティイベントの適切なログ記録が実装されているか
* 異常なアクセスパターンを検出する仕組みがあるか
* インシデント対応プランが準備されているか
* 【GraphQL】複雑なクエリや異常なクエリパターンの検出と警告が実装されているか

## Cloudflare/サーバレス固有の考慮点 ☁️
* Worker KV/D1のアクセス制御設定は適切か
* 環境変数とシークレット管理が適切か
* Cloudflare WAFルールやセキュリティ設定が最適化されているか
* コールドスタートを悪用した攻撃への対策はあるか
* 【GraphQL】Cloudflareのパフォーマンス最適化機能とGraphQLの統合は適切か

## GraphQL固有のセキュリティ対策 🔍
* クエリの複雑さと深さの制限が設定されているか
* バッチクエリに対する制限が実装されているか
* イントロスペクションクエリが本番環境で制限されているか
* クエリのホワイトリスト化またはパーシステントクエリが検討されているか
* クエリコストの分析とクエリ予算の設定がされているか
* リクエストタイムアウトが適切に設定されているか
* エラーメッセージで過度な情報が漏洩していないか
* フラグメントのネスト制限が設定されているか
* エイリアスの使用制限が設定されているか
* subscription機能を使用する場合、適切なレート制限とタイムアウトが設定されているか